{% load static %}
{% load i18n %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.72.0">
    <title>CSA Systems</title>

    {#    <link rel="canonical" href="https://v5.getbootstrap.com/docs/5.0/examples/dashboard/">#}

    <script src="{% static 'dashC/js/core/jquery-3.5.1.min.js' %}"></script>
    <link href="{% static 'bootstrap_4_4/css/bootstrap.css' %}" rel="stylesheet">


    <!-- Custom styles for this template -->
    <link href="{% static 'csa/csa.css' %}" rel="stylesheet">
    <link href="{% static 'bootstrap_4_4/css/bootstrap4-toggle.css' %}" rel="stylesheet">
</head>
<body>
<div id="mainPreloader">
    <div class="wrapper">
        <div class="loader-circle"></div>
        <div class="loader-bottom"><h1>Обновление данных с Online</h1></div>
    </div>
</div>
<style>
    #mainPreloader {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        z-index: 10000;
        margin: 0;
        padding: 0;
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        -ms-flex-direction: column;
        flex-direction: column;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        justify-content: center;
        background: #4de2ac;
    }

    #mainPreloader .wrapper {
        position: relative;
        width: 300px;
        height: 300px;
        background: #4de2ac;
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        -ms-flex-direction: column;
        flex-direction: column;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        justify-content: center;
    }

    #mainPreloader .wrapper .loader-circle {
        width: 60%;
        height: 60%;
        border-radius: 50%;
        border: 30px solid transparent;
        border-left-color: #fff;
        -webkit-animation: load 0.9s ease-in-out alternate infinite;
        animation: load 0.9s ease-in-out alternate infinite;
    }

    #mainPreloader .wrapper .loader-bottom {
        position: absolute;
        width: 100%;
        height: 50%;
        top: 50%;
        background: #4de2ac;
        text-align: center;
        color: #fff;
        -webkit-animation: pulse 0.45s linear alternate infinite;
        animation: pulse 0.45s linear alternate infinite;
    }

    @-webkit-keyframes load {
        0% {
            -webkit-transform: rotate(-35deg);
            transform: rotate(-35deg);
        }
        18% {
            border-width: 18px;
        }
        50% {
            border-width: 4px;
        }
        82% {
            border-width: 18px;
        }
        100% {
            -webkit-transform: rotate(215deg);
            transform: rotate(215deg);
        }
    }

    @keyframes load {
        0% {
            -webkit-transform: rotate(-35deg);
            transform: rotate(-35deg);
        }
        18% {
            border-width: 18px;
        }
        50% {
            border-width: 4px;
        }
        82% {
            border-width: 18px;
        }
        100% {
            -webkit-transform: rotate(215deg);
            transform: rotate(215deg);
        }
    }

    @-webkit-keyframes pulse {
        0% {
            color: #fff;
        }
        100% {
            color: rgba(255, 255, 255, 0.5);
        }
    }

    @keyframes pulse {
        0% {
            color: #fff;
        }
        100% {
            color: rgba(255, 255, 255, 0.5);
        }
    }
</style>
<nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-md-3 col-lg-2 mr-0 px-3" href="#">OmniComm PRO</a>
    <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-toggle="collapse"
            data-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
    <ul class="navbar-nav px-3">
        <li class="nav-item text-nowrap">
            <a class="nav-link" href="{% url 'logout' %}">{% trans 'Выход' %}</a>
        </li>
    </ul>
</nav>

<div class="container-fluid">
    <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            {#                            <span data-feather="file"></span>#}
                            <button id="btn_online" class="btn btn-danger w-100">Нет данных с Online, запросить?
                            </button>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <button id="btn_1c" type="button" class="btn btn-danger w-100" data-toggle="modal"
                                    data-target="#fileUploadModal">
                                Нет данных с 1c, запросить?
                            </button>

                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <button id="ssss" type="button" class="btn btn-danger w-100">
                                Поиск
                            </button>

                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" {# aria-current="page" #} id="pills-home-tab" data-toggle="pill"
                           href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">
                            <span data-feather="home"></span>
                            1c Data Table
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="pills-onlide-tab" data-toggle="pill" href="#pills-online" role="tab"
                           aria-controls="pills-profile" aria-selected="false">
                            <span data-feather="file"></span>
                            Online Date
                        </a>
                    </li>
                    <li class="nav-item">
                        <hr>
                    </li>
                    <li class="nav-item">
                        <p class="nav-link">
                            <span data-feather="file"></span>
                            <span class="a-center" data-feather="shopping-cart"></span>
                            Отчеты:
                        </p>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="pills-no_id-tab" data-toggle="pill" href="#pills-no_id" role="tab"
                           aria-controls="pills-no_id" aria-selected="false">
                            <span data-feather="file"></span>
                            Нет ID (из 1С)
                            <span id="count_no_id"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="pills-no_pay-tab" data-toggle="pill" href="#pills-no_pay" role="tab"
                           aria-controls="pills-no_pay" aria-selected="false">
                            <span data-feather="file"></span>
                            Нет актуальных счетов
                            <span id="count_no_pay"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="pills-true_online_false_1c-tab" data-toggle="pill"
                           href="#pills-true_online_false_1c" role="tab"
                           aria-controls="pills-true_online_false_1c" aria-selected="false">
                            <span data-feather="file"></span>
                            Есть в Online, Нет в 1с
                            <span id="count_true_online_false_1c"></span>
                        </a>
                    </li>
                </ul>


            </div>
            <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"
                style="position: absolute; bottom: 0">
                <span>По состоянию: NONE</span>
                <a class="link-secondary" href="#" aria-label="Add a new report">
                    <span data-feather="plus-circle"></span>
                </a>
            </h6>
        </nav>

        <main class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">CSA Dashboard</h1>
                <div class="btn-toolbar mb-2 mb-md-0">
                    <div class="btn-group mr-2">
                        {#                        <button type="button" class="btn btn-sm btn-outline-secondary">Настройка списка</button>#}
                        <button type="button" class="btn btn-sm btn-outline-secondary" data-toggle="modal"
                                data-target="#settingsListdModal">
                            Настройка списка
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Экспорт</button>
                        <button type="button" class="btn btn-sm btn-outline-secondary">Обновить</button>
                    </div>
                    <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                        <span data-feather="calendar"></span>
                        This week
                    </button>
                </div>
            </div>
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                    <h2>Данные из 1с</h2>
                    {{ 1c_data_info.dict_org }}
                    {#                    {{ 1c_data_info.dict_part }}#}
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead class="text-center">
                            <tr>
                                <th rowspan="2" class="b_line">Организация</th>
                                <th rowspan="2" class="b_line">Партнер</th>
                                <th rowspan="2" class="b_line">ИНН</th>
                                <th rowspan="2" class="b_line">ТС</th>
                                <th rowspan="2" class="b_line">ГосНомер</th>
                                <th rowspan="2" class="b_line">ИД</th>
                                {#                        <th rowspan="2" class="b_line">Server_login</th>#}
                                <th rowspan="2" class="b_line">Активно</th>
                                {#                        <th rowspan="2" class="b_line">Блокировка с</th>#}
                                <th colspan="3">Начисления</th>
                                <th colspan="2">Счет</th>
                            </tr>
                            <style>
                                .b_line {
                                    border-bottom-color: currentColor;
                                }
                            </style>
                            <tr>

                                <th>Номер</th>
                                <th>Дата</th>
                                <th>Сумма</th>
                                <th>Номер</th>
                                <th>Дата</th>
                            </tr>
                            </thead>
                            <tbody class='table-hover'>
                            <tr class="b_line text-center">

                                <td>1</td>
                                <td>2</td>
                                <td>3</td>
                                <td>4</td>
                                <td>5</td>
                                <td>6</td>
                                <td>7</td>
                                <td>8</td>
                                <td>9</td>
                                <td>10</td>
                                <td>11</td>
                                <td>12</td>
                            </tr>

                            {% for el in 1c_data.other %}
                                <tr>
                                    <td>{{ el.org }}</td>
                                    <td>{{ el.part }}</td>
                                    <td>{{ el.inn }}</td>
                                    <td>{{ el.avto }}</td>
                                    <td>{{ el.a_number }}</td>
                                    <td>{{ el.id }}</td>
                                    <td>{{ el.isActive }}</td>
                                    <td>{{ el.num_nach }}</td>
                                    <td>{{ el.date_nach }}</td>
                                    <td>{{ el.sum_nach }}</td>
                                    <td>{{ el.num_pay }}</td>
                                    <td>{{ el.date_pay }}</td>
                                </tr>

                            {% empty %}
                                <div> Нет данных</div>

                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-pane fade" id="pills-online" role="tabpanel" aria-labelledby="pills-onlide-tab">
                    <h2>Данные из Online</h2>
                    <div class="table-responsive">
                        <table id="data_online_raw" class="table table-striped table-sm">
                            <thead>

                            <tr class="text-center">

                                <th>ID</th>
                                <th>Номер</th>
                                <th>Логин</th>
                                <th>IMEI</th>
                                <th>Сотовый номер</th>
                            </tr>
                            </thead>
                            <tbody id="data_online_raw">
                            <tr class="b_line text-center">

                                <td>1</td>
                                <td>2</td>
                                <td>3</td>
                                <td>4</td>
                                <td>5</td>
                            </tr>

                            {% for el in online.list_online %}
                                <tr>
                                    <td>{{ el.ID }}</td>
                                    <td>{{ el.Number }}</td>
                                    <td>{{ el.login }}</td>
                                    <td>{{ el.IMEI }}</td>
                                    <td>{{ el.phone }}</td>
                                </tr>


                            {% empty %}


                            {% endfor %}


                            </tbody>
                        </table>

                    </div>
                </div>


                <div class="tab-pane fade" id="pills-no_id" role="tabpanel" aria-labelledby="pills-no_id-tab">
                    <h2>Данные из 1C</h2>
                    <h5>Клиенты по которым нет id в 1С</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead class="text-center">
                            <tr>
                                <th rowspan="2" class="b_line">Организация</th>
                                <th rowspan="2" class="b_line">Партнер</th>
                                <th rowspan="2" class="b_line">ИНН</th>
                                <th rowspan="2" class="b_line">ТС</th>
                                <th rowspan="2" class="b_line">ГосНомер</th>
                                <th rowspan="2" class="b_line">ИД</th>
                                {#                        <th rowspan="2" class="b_line">Server_login</th>#}
                                <th rowspan="2" class="b_line">Активно</th>
                                {#                        <th rowspan="2" class="b_line">Блокировка с</th>#}
                                <th colspan="3">Начисления</th>
                                <th colspan="2">Счет</th>
                            </tr>
                            <style>
                                .b_line {
                                    border-bottom-color: currentColor;
                                }
                            </style>
                            <tr>

                                <th>Номер</th>
                                <th>Дата</th>
                                <th>Сумма</th>
                                <th>Номер</th>
                                <th>Дата</th>
                            </tr>
                            </thead>
                            <tbody class='table-hover'>
                            <tr class="b_line text-center">

                                <td>1</td>
                                <td>2</td>
                                <td>3</td>
                                <td>4</td>
                                <td>5</td>
                                <td>6</td>
                                <td>7</td>
                                <td>8</td>
                                <td>9</td>
                                <td>10</td>
                                <td>11</td>
                                <td>12</td>
                            </tr>

                            {% for el in 1c_data.noID %}
                                <tr>
                                    <td>{{ el.org }}</td>
                                    <td>{{ el.part }}</td>
                                    <td>{{ el.inn }}</td>
                                    <td>{{ el.avto }}</td>
                                    <td>{{ el.a_number }}</td>
                                    <td>{{ el.id }}</td>
                                    <td>{{ el.isActive }}</td>
                                    <td>{{ el.num_nach }}</td>
                                    <td>{{ el.date_nach }}</td>
                                    <td>{{ el.sum_nach }}</td>
                                    <td>{{ el.num_pay }}</td>
                                    <td>{{ el.date_pay }}</td>
                                </tr>

                            {% empty %}
                                <div> Нет данных</div>

                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-pane fade" id="pills-no_pay" role="tabpanel" aria-labelledby="pills-no_pay-tab">
                    <h2>Данные из 1C</h2>
                    <h5> Нет актуальных счетов, теряем деньги...</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead class="text-center">
                            <tr>
                                <th rowspan="2" class="b_line">Организация</th>
                                <th rowspan="2" class="b_line">Партнер</th>
                                <th rowspan="2" class="b_line">ИНН</th>
                                <th rowspan="2" class="b_line">ТС</th>
                                <th rowspan="2" class="b_line">ГосНомер</th>
                                <th rowspan="2" class="b_line">ИД</th>
                                {#                        <th rowspan="2" class="b_line">Server_login</th>#}
                                <th rowspan="2" class="b_line">Активно</th>
                                {#                        <th rowspan="2" class="b_line">Блокировка с</th>#}
                                <th colspan="3">Начисления</th>
                                <th colspan="2">Счет</th>
                            </tr>
                            <style>
                                .b_line {
                                    border-bottom-color: currentColor;
                                }
                            </style>
                            <tr>

                                <th>Номер</th>
                                <th>Дата</th>
                                <th>Сумма</th>
                                <th>Номер</th>
                                <th>Дата</th>
                            </tr>
                            </thead>
                            <tbody class='table-hover'>
                            <tr class="b_line text-center">

                                <td>1</td>
                                <td>2</td>
                                <td>3</td>
                                <td>4</td>
                                <td>5</td>
                                <td>6</td>
                                <td>7</td>
                                <td>8</td>
                                <td>9</td>
                                <td>10</td>
                                <td>11</td>
                                <td>12</td>
                            </tr>

                            {% for el in 1c_data.other %}
                                {% if not el.data_pay or el.date_nach != '30.07.2020' %}
                                    <tr>
                                        <td>{{ el.org }}</td>
                                        <td>{{ el.part }}</td>
                                        <td>{{ el.inn }}</td>
                                        <td>{{ el.avto }}</td>
                                        <td>{{ el.a_number }}</td>
                                        <td>{{ el.id }}</td>
                                        <td>{{ el.isActive }}</td>
                                        <td>{{ el.num_nach }}</td>
                                        <td>{{ el.date_nach }}</td>
                                        <td>{{ el.sum_nach }}</td>
                                        <td>{{ el.num_pay }}</td>
                                        <td>{{ el.date_pay }}</td>
                                    </tr>
                                {% endif %}

                            {% empty %}
                                <div> Нет данных</div>

                            {% endfor %}
                            </tbody>
                    </div>
                </div>
                <div class="tab-pane fade" id="pills-true_online_false_1c" role="tabpanel"
                     aria-labelledby="pills-true_online_false_1c-tab">
                    <h2>Данные из Online</h2>
                    <h5>Машина отсутствует или не распознана в 1С...</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-sm">
                            <thead>
                            <tr class="text-center">

                                <th>ID</th>
                                <th>Номер</th>
                                <th>Логин</th>
                                <th>IMEI</th>
                                <th>Сотовый номер</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr class="b_line text-center">

                                <td>1</td>
                                <td>2</td>
                                <td>3</td>
                                <td>4</td>
                                <td>5</td>
                            </tr>

                            {% for el in online %}
                                <tr>
                                    <td>{{ el.vehicleID }}</td>
                                    <td>{{ el.vehicleName }}</td>
                                    <td>{{ el.serverLogin }}</td>
                                    <td>{{ el.IMEI }}</td>
                                    <td>{{ el.Sot_number }}</td>
                                </tr>

                            {% empty %}
                                <div> Нет данных</div>

                            {% endfor %}


                            </tbody>
                        </table>
                        {% for string in table %}

                        {% endfor %}
                    </div>
                </div>
                {#                {% endif %}#}

            </div>
        </main>
    </div>
</div>

<div class="modal fade" id="settingsListdModal" tabindex="-1" role="dialog"
     aria-labelledby="settingsListdModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5>Настройки</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body text-center">
                <details>
                    <summary class="text-left">Настройка таблиц</summary>
                    <details class="text-left">
                        <summary class="ml-2">Показать столбцы из 1с ...</summary>
                        <div class="text-center">
                            <label class="m-2">
                                <input id="org" type="checkbox" checked data-toggle="toggle"
                                       data-on="Организация"
                                       data-off="Организация"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="part" type="checkbox" checked data-toggle="toggle"
                                       data-on="Партнер"
                                       data-off="Партнер"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="inn" type="checkbox" checked data-toggle="toggle"
                                       data-on="ИНН"
                                       data-off="ИНН"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="kpp" type="checkbox" checked data-toggle="toggle"
                                       data-on="КПП"
                                       data-off="КПП"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="avto" type="checkbox" checked data-toggle="toggle"
                                       data-on="ТС"
                                       data-off="ТС"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="a_number" type="checkbox" checked data-toggle="toggle"
                                       data-on="Номер ТС"
                                       data-off="Номер ТС"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="id" type="checkbox" checked data-toggle="toggle"
                                       data-on="ИД"
                                       data-off="ИД"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="isActive" type="checkbox" checked data-toggle="toggle"
                                       data-on="Активно"
                                       data-off="Активно"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="end_nach" type="checkbox" checked data-toggle="toggle"
                                       data-on="Блокирован с"
                                       data-off="Блокирован С"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="num_nach" type="checkbox" checked data-toggle="toggle"
                                       data-on="№ Начисления"
                                       data-off="№ Начисления"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="date_nach" type="checkbox" checked data-toggle="toggle"
                                       data-on="Дата нач-я"
                                       data-off="Дата нач-я"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="sum_nach" type="checkbox" checked data-toggle="toggle"
                                       data-on="Сумма Нач-я"
                                       data-off="Сумма Нач-я"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="num_pay" type="checkbox" checked data-toggle="toggle"
                                       data-on="№ Счета"
                                       data-off="№ Счета"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="date_pay" type="checkbox" checked data-toggle="toggle"
                                       data-on="Дата Счета"
                                       data-off="Дата Счета"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>

                        </div>

                    </details>

                    <details class="text-left">
                        <summary class="ml-2">Показать столбцы из Online ...</summary>
                        <div class="text-center">
                            <label class="m-2">
                                <input id="vehicleID" type="checkbox" checked data-toggle="toggle"
                                       data-on="ИД"
                                       data-off="ИД"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="vehicleName" type="checkbox" checked data-toggle="toggle"
                                       data-on="ТС"
                                       data-off="ТС"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="serverLogin" type="checkbox" checked data-toggle="toggle"
                                       data-on="Логин"
                                       data-off="Логин"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="IMEI" type="checkbox" checked data-toggle="toggle"
                                       data-on="IMEI"
                                       data-off="IMEI"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>
                            <label class="m-2">
                                <input id="Sot_number" type="checkbox" checked data-toggle="toggle"
                                       data-on="Сот Номер"
                                       data-off="Сот Номер"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>

                        </div>


                    </details>

                </details>
                <details>
                    <summary class="text-left">Настройка анализа</summary>
                    <label class="m-2">
                        <input id="dubli" type="checkbox" checked data-toggle="toggle"
                               data-on="Показать Дубли"
                               data-off="Скрыть Дубли"
                               data-width="180" data-height="40" data-style="slow"/>
                    </label>
                    <label class="m-2">
                        <input id="comment" type="checkbox" checked data-toggle="toggle"
                               data-on="Комментарии"
                               data-off="Комментарии"
                               data-width="180" data-height="40" data-style="slow"/>
                    </label>
                </details>

                {#                <h4>Показать столбцы из 1с </h4>#}


            </div>
            <div class="modal-footer" style="padding: -15px">
                <button id="" type="button"
                        class="btn btn-outline-danger">Отмена
                </button>
                <button id="" type="button" class="btn btn-outline-primary  ml-auto">
                    Применить
                </button>
                {#                <label>#}
                {#                    <input id="" type="checkbox" checked data-toggle="toggle"#}
                {#                           data-on=""#}
                {#                           data-off="Локально"#}
                {#                           data-width="180" data-height="40" data-style="slow"/>#}
                {#                </label>#}
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="fileUploadModal" tabindex="-1" role="dialog"
     aria-labelledby="fileUploadModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div id="modalSend1cContent" class="modal-content">
            <div class="modal-header">
                <h5>Загрузить данные с 1с</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="file-upload">
                    <div class="image-upload-wrap">
                        <form id="form_send_1c_data" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            <input class="file-upload-input" name="1c_data" type='file' onchange="readURL(this);"/>
                            <div class="drag-text">
                                <h3>Перенесите или выберите otchet.csv</h3>
                            </div>
                        </form>
                    </div>
                    <div class="file-upload-content">
                        <h5 class="mb-2">Прочитаны следующие данные</h5>
                        <div>
                            <ul id="pole" style="column-count: 2;list-style: none;">

                            </ul>
                        </div>
                        <div class="image-title-wrap">

                        </div>
                        <div class="modal-footer" style="padding: -15px">
                            <button id="erase_data_btn" type="button" onclick="removeUpload()"
                                    class="btn btn-outline-danger ">Удалить
                            </button>
                            <button id="send_1c_to_server" type="button"
                                    class="btn btn-outline-primary ml-auto">
                                Анализ
                            </button>
                            <label>
                                <input id="state_analis_data" type="checkbox" checked data-toggle="toggle"
                                       data-on="На сервере"
                                       data-off="Локально"
                                       data-width="180" data-height="40" data-style="slow"/>
                            </label>

                        </div>
                    </div>

                </div>
            </div>
            {#            <div class="preloader align-middle">#}
            <div id="loader" class="load-wrapp align-middle">
                <div class="load-6 align-middle" style="margin-top: 100px">
                    <div class="letter-holder">
                        <span class="l-1 letter">А</span>
                        <span class="l-2 letter">н</span>
                        <span class="l-3 letter">а</span>
                        <span class="l-4 letter">л</span>
                        <span class="l-5 letter">и</span>
                        <span class="l-6 letter">з</span>
                        <span class="l-7 letter">.</span>
                        <span class="l-8 letter">.</span>
                        <span class="l-9 letter">.</span>
                        <span class="l-10 letter">.</span>
                    </div>
                </div>
            </div>
            {#            </div>#}
        </div>
    </div>
</div>
<style>

    .load-wrapp {
    {#float: left;#} display: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        margin: 0 50% 10px 0;
        padding: 20px 20px 20px;
        border-radius: 5px;
        text-align: center;
        vertical-align: middle;
        background-color: #ffffff;
    }


    .load-wrapp:last-child {
        margin-right: 0;
    }

    .letter {
        text-align: center;
        vertical-align: middle;
        font-size: 42px;
        color: #0025f1;
    }

    .load-6 .letter {
        animation-name: loadingF;
        animation-duration: 1.6s;
        animation-iteration-count: infinite;
        animation-direction: linear;
    }


    .l-1 {
        animation-delay: 0.48s;
    }

    .l-2 {
        animation-delay: 0.6s;
    }

    .l-3 {
        animation-delay: 0.72s;
    }

    .l-4 {
        animation-delay: 0.84s;
    }

    .l-5 {
        animation-delay: 0.96s;
    }

    .l-6 {
        animation-delay: 1.08s;
    }

    .l-7 {
        animation-delay: 1.2s;
    }

    .l-8 {
        animation-delay: 1.32s;
    }

    .l-9 {
        animation-delay: 1.44s;
    }

    .l-10 {
        animation-delay: 1.56s;
    }

    @keyframes loadingF {
        0% {
            opacity: 0;
        }
        100% {
            opacity: 1;
        }
    }

    .file-upload {
        background-color: #ffffff;
        width: 100%;
        margin: 0 auto;
        padding: 0px;
    }

    .slow .toggle-group {
        transition: left 0.7s;
        -webkit-transition: left 0.7s;
    }


    .file-upload-content {
        display: none;
        text-align: center;
    }

    .file-upload-input {
        position: absolute;
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        outline: none;
        opacity: 0;
        cursor: pointer;
    }

    .image-upload-wrap {
        margin-top: 20px;
        border: 4px dashed #0062cc;
        position: relative;
    }

    .image-dropping,
    .image-upload-wrap:hover {
        background-color: #0062cc;
        border: 4px dashed #ffffff;
    }

    .image-title-wrap {
        padding: 0 15px 15px 15px;
        color: #222;
    }

    .drag-text {
        text-align: center;
        color: #0062cc;
    }

    .drag-text h3 {
        font-weight: 100;
        text-transform: uppercase;
        color: #ffffff;
        padding: 60px 0;
    }


    .remove-image:hover {
        background: #c13b2a;
        color: #ffffff;
        transition: all .2s ease;
        cursor: pointer;
    }

    .remove-image:active {
        border: 0;
        transition: all .2s ease;
    }
</style>
<script>
    let file;
    let reader;
    $('#erase_data_btn').hide();
    $('#send_1c_to_server').hide();
    $('#send_1c_to_server').on('click', function () {
        $('#loader').show();
        if ($('#state_analis_data').parent().hasClass('off')) {
            alert('ComeSoon...');
        } else {
            $('#form_send_1c_data').submit();
        }
    })

    function readURL(input) {
        if (input.files && input.files[0]) {

            reader = new FileReader();

            reader.onload = function (e) {
                $('.image-upload-wrap').hide();

                $('.file-upload-image').attr('src', e.target.result);
                $('.file-upload-content').show();

                $('.image-title').html(input.files[0].name);


                let header = reader.result.split('\n')[0].split(';');
                header.forEach(function (item) {
                    $('#pole').append('<li class="text-left">' + item + '</li>');

                })
                $('#pole').parent().append('<h5 class="mb-1">Всего ' + reader.result.split('\n').length + ' записей</h5>');
                let options = {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'};
                $('#pole').parent().append('<h5 class="mb-1">Актуальность: ' + new Date(file.lastModified).toLocaleString('ru-RU', options) + '</h5>');
                $('#erase_data_btn').show();
                $('#send_1c_to_server').show();
            };
            file = input.files[0];


            reader.readAsText(file);


            reader.onerror = function () {
                console.log(reader.error);
            };
            console.log(`File name: ${file.name}`); // например, my.png
            console.log(`Last modified: ${file.lastModified}`); // например, 1552830408824

        } else {
            removeUpload();
        }
    }

    function search(str) {
        $('#ssss').on('click', function () {
            let tbody = $('#data_online_raw').children()
            {#tbody.forEach(elem => function (elem){#}
            {#    elem.hide()#}

            for (item of tbody)
                item.hide()
        })
    }

    function removeUpload() {
        $('.file-upload-input').replaceWith($('.file-upload-input').clone());
        $('.file-upload-content').hide();
        $('.image-upload-wrap').show();
        $('#erase_data_btn').hide();
        $('#send_1c_to_server').hide();
    }

    $('.image-upload-wrap').bind('dragover', function () {
        $('.image-upload-wrap').addClass('image-dropping');
    });
    $('.image-upload-wrap').bind('dragleave', function () {
        $('.image-upload-wrap').removeClass('image-dropping');
    });

    {% if list_1c_size != 0 %}

        $('#btn_1c').text('1c: {{ 1c_data_info.IDENT }} объектов');
        $('#btn_1c').removeClass('btn-danger');
        $('#btn_1c').addClass('btn-success');
        {#$('#btn_1c').css('background-color','green');#}

    {% endif %}
    {% if list_online_size != 0 %}

        $('#btn_online').text('Online: {{ online.count }} объектов');
        $('#btn_online').removeClass('btn-danger');
        $('#btn_online').addClass('btn-success');
        $('#mainPreloader').hide();
        {#$('#btn_1c').css('background-color','green');#}

    {% endif %}

</script>

<script src="{% static 'bootstrap_4_4/js/bootstrap.min.js' %}"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.24.1/feather.min.js"
        integrity="sha384-EbSscX4STvYAC/DxHse8z5gEDaNiKAIGW+EpfzYTfQrgIlHywXXrM9SUIZ0BlyfF"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"
        integrity="sha384-i+dHPTzZw7YVZOx9lbH5l6lP74sLRtMtwN2XjVqjf3uAGAREAF4LMIUDTWEVs4LI"
        crossorigin="anonymous"></script>
<script src="{% static 'csa/csa.js' %}"></script>
<script src="{% static 'bootstrap_4_4/js/bootstrap4-toggle.js' %}"></script>


</body>
</html>
